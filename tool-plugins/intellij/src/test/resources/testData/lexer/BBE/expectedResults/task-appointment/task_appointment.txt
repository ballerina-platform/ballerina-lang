import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('io')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('math')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('runtime')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('task')
; (';')
WHITE_SPACE ('\n\n')
int ('int')
WHITE_SPACE (' ')
identifier ('app1Count')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('0')
; (';')
WHITE_SPACE ('\n')
identifier ('task')
: (':')
identifier ('Appointment')
? ('?')
WHITE_SPACE (' ')
identifier ('appointment1')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n')
PUBLIC ('public')
WHITE_SPACE (' ')
function ('function')
WHITE_SPACE (' ')
identifier ('main')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
worker ('worker')
WHITE_SPACE (' ')
identifier ('w1')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"------------- Scheduling Appointments -------------"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
( ('(')
function ('function')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment1Cleanup')
; (';')
WHITE_SPACE ('\n        ')
( ('(')
function ('function')
( ('(')
error ('error')
) (')')
) (')')
WHITE_SPACE (' ')
identifier ('onErrorFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('cleanupError')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 1 runs every 20 seconds.')
WHITE_SPACE ('\n        ')
identifier ('appointment1')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                            ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                            ')
QUOTED_STRING_LITERAL ('"0/20 * * * * ?"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment1')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 2 runs every other minute (at 15 seconds past the minute).')
WHITE_SPACE ('\n        ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment2Cleanup')
; (';')
WHITE_SPACE ('\n        ')
identifier ('task')
: (':')
identifier ('Appointment')
WHITE_SPACE (' ')
identifier ('appointment2')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE ('\n                  ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                       ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                       ')
QUOTED_STRING_LITERAL ('"15 0/2 * * * ?"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment2')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 3 runs every other minute but only between 8am and 5pm.')
WHITE_SPACE ('\n        ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment3Cleanup')
; (';')
WHITE_SPACE ('\n        ')
identifier ('task')
: (':')
identifier ('Appointment')
WHITE_SPACE (' ')
identifier ('appointment3')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE ('\n                  ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                       ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                       ')
QUOTED_STRING_LITERAL ('"0 0/2 8-17 * * ?"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment3')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 4 runs every three minutes but only between 5pm and 11pm.')
WHITE_SPACE ('\n        ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment4Cleanup')
; (';')
WHITE_SPACE ('\n        ')
identifier ('task')
: (':')
identifier ('Appointment')
WHITE_SPACE (' ')
identifier ('appointment4')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE ('\n                  ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                       ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                       ')
QUOTED_STRING_LITERAL ('"0 0/3 17-23 * * ?"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment4')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 5 runs at 10am on the 1st and the 15th days of the month.')
WHITE_SPACE ('\n        ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment5Cleanup')
; (';')
WHITE_SPACE ('\n        ')
identifier ('task')
: (':')
identifier ('Appointment')
WHITE_SPACE (' ')
identifier ('appointment5')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE ('\n                  ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                       ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                       ')
QUOTED_STRING_LITERAL ('"0 0 10am 1,15 * ?"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment5')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 6 runs every 30 seconds but only on weekdays')
WHITE_SPACE ('\n        ')
LINE_COMMENT ('// (i.e., Monday through Friday).')
WHITE_SPACE ('\n        ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment6Cleanup')
; (';')
WHITE_SPACE ('\n        ')
identifier ('task')
: (':')
identifier ('Appointment')
WHITE_SPACE (' ')
identifier ('appointment6')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE ('\n                  ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                       ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                       ')
QUOTED_STRING_LITERAL ('"0,30 * * ? * MON-FRI"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment6')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('//job 7 runs every 30 seconds but only on weekends')
WHITE_SPACE ('\n        ')
LINE_COMMENT ('// (i.e., Saturday and Sunday).')
WHITE_SPACE ('\n        ')
identifier ('onTriggerFunction')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment7Cleanup')
; (';')
WHITE_SPACE ('\n        ')
identifier ('task')
: (':')
identifier ('Appointment')
WHITE_SPACE (' ')
identifier ('appointment7')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE ('\n                  ')
new ('new')
WHITE_SPACE (' ')
identifier ('task')
: (':')
identifier ('Appointment')
( ('(')
identifier ('onTriggerFunction')
, (',')
WHITE_SPACE ('\n                                       ')
identifier ('onErrorFunction')
, (',')
WHITE_SPACE ('\n                                       ')
QUOTED_STRING_LITERAL ('"0,30 * * ? * SAT,SUN"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('appointment7')
. ('.')
identifier ('schedule')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
identifier ('runtime')
: (':')
identifier ('sleep')
( ('(')
DECIMAL_INTEGER_LITERAL ('60000')
) (')')
; (';')
WHITE_SPACE (' ')
LINE_COMMENT ('// Sleep thread to avoid exiting')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n    ')
wait ('wait')
WHITE_SPACE (' ')
identifier ('w1')
; (';')
WHITE_SPACE (' ')
LINE_COMMENT ('// Wait for the worker to finish.')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment1Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#1 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
identifier ('app1Count')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('app1Count')
WHITE_SPACE (' ')
+ ('+')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('1')
; (';')
WHITE_SPACE ('\n    ')
if ('if')
WHITE_SPACE (' ')
( ('(')
identifier ('app1Count')
WHITE_SPACE (' ')
== ('==')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('5')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Stopping Appointment#1 cleanup task since it\n                       has run 5 times"')
) (')')
; (';')
WHITE_SPACE ('\n\n        ')
LINE_COMMENT ('// This is how you cancel an appointment.')
WHITE_SPACE ('\n        ')
identifier ('appointment1')
. ('.')
identifier ('cancel')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment2Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#2 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment3Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#3 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment4Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#4 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment5Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#5 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment6Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#6 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('appointment7Cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment#7 cleanup running..."')
) (')')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('cleanup')
( ('(')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
( ('(')
error ('error')
? ('?')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Cleaning up"')
) (')')
; (';')
WHITE_SPACE ('\n    ')
if ('if')
WHITE_SPACE (' ')
( ('(')
identifier ('math')
: (':')
identifier ('randomInRange')
( ('(')
DECIMAL_INTEGER_LITERAL ('0')
, (',')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('10')
) (')')
WHITE_SPACE (' ')
== ('==')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('5')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
error ('error')
WHITE_SPACE (' ')
identifier ('e')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
error ('error')
( ('(')
QUOTED_STRING_LITERAL ('"Cleanup error"')
) (')')
; (';')
WHITE_SPACE ('\n        ')
return ('return')
WHITE_SPACE (' ')
identifier ('e')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('cleanupError')
( ('(')
error ('error')
WHITE_SPACE (' ')
identifier ('e')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('print')
( ('(')
QUOTED_STRING_LITERAL ('"[ERROR] cleanup failed"')
) (')')
; (';')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
identifier ('e')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
